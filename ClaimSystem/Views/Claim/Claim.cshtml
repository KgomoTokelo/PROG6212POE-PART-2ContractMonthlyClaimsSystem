@model IEnumerable<ClaimSystem.Models.Claim>

@{
    ViewData["Title"] = "Claims";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Claims</h2>
    <div class="d-flex">
        <a asp-controller="UploadDocuments" asp-action="Upload" class="btn btn-secondary me-2">
            <i class="bi bi-upload"></i> Upload
        </a>
        <a asp-action="CreateClaim" class="btn btn-success">
            + Submit New Claim
        </a>
    </div>
</div>


<div class="row">
    @if (Model == null || !Model.Any())
    {
        <div class="col-12 text-center mt-4">
            <h5 class="text-muted">No claims submitted yet.</h5>
        </div>
    }
    else
    {
        @foreach (var claim in Model)
        {
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body text-center">
                        <img src="https://via.placeholder.com/100"
                             class="rounded-circle mb-2" alt="Lecturer Pic">

                        <h5 class="card-title">@claim.Lecturer.Name </h5>
                        <p class="text-muted">@claim.Lecturer.Department</p>

                        <p><strong>ClaimID:</strong> @claim.ClaimID</p>
                        <p><strong>Module:</strong> @claim.ModuleName</p>
                        <p><strong>Date:</strong> @claim.SubmissionDate.ToShortDateString()</p>

                        <p>
                            <strong>Status:</strong>
                            <span class="badge
                                        @(claim.Status == ClaimSystem.Models.Claim.status.Approved ? "bg-success" :
                                                                    claim.Status == ClaimSystem.Models.Claim.status.Submitted ? "bg-info" :
                                                                    claim.Status == ClaimSystem.Models.Claim.status.Rejected ? "bg-danger" :
                                                                    "bg-secondary")">
                        @claim.Status
                    </span>
                </p>

                        <p><strong>Hours:</strong> @claim.HoursWorked</p>
                        <p><strong>Rate:</strong> R @claim.HourlyRate</p>

                        @* this is for total calculations*@
                        @{
                            double x = (double)claim.HoursWorked;
                            double y = (double)claim.HourlyRate;

                            double total = x * y;

                            <p><strong>Estimated amount to be paid:</strong> R @total</p>
                        }

                        <a asp-action="Views" asp-route-id="@claim.ClaimID"
                           class="btn btn-primary btn-sm">View</a>
                    </div>
                </div>
            </div>
        }
    }
</div>
